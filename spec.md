# 编码规范

## 文档
1. 复杂的设计：必须写文档（注释）详细说明设计思路、代码流程。
2. 为解决某些特定问题、或会让人觉得意外的代码，必须写文档（注释）说明原因。

## 目录结构（试点验证）
1. 系统的大模块与数据库的schema一一对应，并且名称相同。每个大模块作为一个单独目录。
  大模块只作为小模块的分类，包含小模块目录，尽量不写代码在大模块中（除非要同时操作多个小模块）。
2. 系统的小模块与数据库的table 一一对应，并且名称相同。每个小模块作为大模块中一个单独的目录。
  小模块目录结构如下：
```
  ├─ applications/ #### 应用：协调repositories和domains来完成应用功能。应该尽量简单，具体的逻辑应该尽量在domains里实现.
  |  ├─ list/         # 列表
  |  ├─ detail/       # 详情
  |  ├─ create/       # 创建
  |  ├─ update/       # 更新
  |  ├─ upsert/       # 有则更新无则创建
  |  ├─ delete/       # 删除
  |  ├─ ...
  |  └─ ...
  |   
  ├─ repositories/ #### 资源库：数据库操作，可以引用domains中定义的数据类型。
  |  ├─ table.go      # 定义表结构，但是不包含表字段对应的任何常量。这些应该放在domains中。
  |  ├─ ...
  |  └─ ...
  |   
  └─ domains/      #### 领域：数据结构与业务逻辑，但是不包含任何数据库操作。不能引用applications和repositories.
      ├─ ...
      └─ ...
```
3. 路由的目录结构使用"大模块/小模块"，不再细分下级目录。`routes.go`作为入口文件，路由定义按照`列表、详情、创建、更新、删除`的顺序排列。
  如果需要分类，也按照`列表、详情、创建、更新、删除`来分类到不同的函数或文件中。

## 命名规范
命名需要注意单数、复数形式，一个的使用单数，多个的使用复数。
   所有的数据库表，应该都使用复数，因为一张表里有多条记录。

1. 目录名：小写下划线风格，不能超过20个字符；
2. 包名：小写下划线风格，不能超过20个字符；
3. 文件名：小写下划线风格，不能超过20个字符；

4. 函数名：驼峰风格，不能超过30个字符；
5. 类型名：驼峰风格，不能超过30个字符；
6. 常量名：驼峰风格，不能超过30个字符；
7. 变量名：驼峰风格，不能超过30个字符；

8. 局部类型名：小驼峰风格，不能超过20个字符；
9. 局部常量名：小驼峰风格，不能超过20个字符；
10. 局部变量名：小驼峰风格，不能超过20个字符；
11. 标签名：小驼峰风格，不能超过20个字符；

## 尺寸规范
1. 目录：包含不能超过20个文件或子目录；
2. 文件：不能超过300行；
3. 函数：不能超过30条语句；
4. 代码行：不能超过100个字符；


## 顺序规范
1. 文件内的代码顺序为：全局公共常量、全局公共变量、类型定义、init函数，函数或方法定义。
2. 非公共的全局变量（比如预编译正则）采用就近定义原则，写在对应的使用函数或方法上方。
3. 入口函数或方法写在文件的最上方。
   非入口函数或方法按照被调用数序（先调用的在上）或者重要程度（重要的在上）排列。

